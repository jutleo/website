<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>iReport+jasperReport之JFreeChart（图表报表）</title>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/static/css/leo.css">
        <link rel="stylesheet" href="/static/css/prettify.css">

    </head>
    <body>
      <div class="leo-head">
        <ul class="leo-nav">
  
    <li><a class="leo-nav-item" href="/">首页</a></li>
  
    <li><a class="leo-nav-item" href="/category.html">归档</a></li>
  
    <li><a class="leo-nav-item" href="/andy.html">豆豆</a></li>
  
    <li><a class="leo-nav-item last" href="/contant.html">联系我</a></li>
  
</ul>

      </div>
          </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8"><div class="leo-category"><h1 class="leo-articel-title">iReport+jasperReport之JFreeChart（图表报表）</h1>
<div class="post">
<p>说完<a href="http://jutleo.github.io/2013/05/03/iReport-jasperReport-08/">iReport+jasperReport之scriptlet</a> 下来就得看看图表了。
jasperReport的图表完全借助于外部的绘图工具，<code>charts</code>和<code>JFreeChart</code>,其中<code>JFreeChart</code>是目前<code>java</code>最火的一个绘图工具了，
还是引用<code>JFreeChart</code>简单使用 来实现我们的图表吧，说到这里澄清一下，本篇写的是<code>jasperReport</code>的图表，下来会专门写一篇关于<code>jasperReport</code>图片报表。
<code>jasperReport</code>不重复发明车轮，在报表中是以一个变量的方式引入外部图表的，下来我们看看是怎么实现的。<br>
 <strong>新建一变量jfreeChart 如图：</strong>  </p>

<p><img src="/static/img/20130502005.jpg" alt="显示效果"> </p>

<p>紧接着我们在报表上放置一图片控件,下来一篇我会详细说说图片问题，右击设置图片控件属性，如图所示：  </p>

<p><img src="/static/img/20130502006.jpg" alt="显示效果"> </p>

<p><code>net.sf.jasperreports.engine.JRRenderable</code>为<code>jasperReport</code>一个专门用来处理图表问题公共接口。
一切OK，现在就是这个变量怎么才能吧jfreechart传递到报表中呢，还记得上篇的<code>scriptlet</code>吗？
新建一<code>JChartReportDemo.java</code>类，继承自<code>JRDefaultScriptlet</code>，当然要实现那些方法不过大部分我们都是空实现而已，
我们只要在<code>afterReportInit</code>方法内绘制图表然后在<code>set</code>进去我们定义的那个变量即可：  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">public void afterReportInit() throws JRScriptletException {

    //create pie chart dataset
    DefaultPieDataset dateset = new DefaultPieDataset();

    //set dataset value
    dateset.setValue(&quot;Chinese&quot;, 108);
    dateset.setValue(&quot;Math&quot;, 110);
    dateset.setValue(&quot;English&quot;, 74);
    dateset.setValue(&quot;Science Department&quot;, 226);

    /*
     * create jfreeChart object
     * the first parameter is pie chart title
     * the secend parameter is dataset of pie chart
     * the three parameter is boolean value,create chart note
     * the four parameter is boolean value,it&#39;s a tooltip of move mouse on
     * configure chart to generate URLs,It&#39;s get a PiePlot3D object
     * 
     */
    JFreeChart freeChart = ChartFactory.createPieChart3D(&quot;Report Pie Chart&quot;, dateset, true, true, false);

    PiePlot3D plot3D = (PiePlot3D) freeChart.getPlot();
    plot3D.setNoDataMessage(&quot;No data to display&quot;);

    // set variable &quot;jfreeChart&quot; value
    this.setVariableValue(&quot;jfreeChart&quot;, new JFreeChartRenderer(freeChart));
}
</code></pre></div>
<p>其中<code>plot3D.setNoDataMessage(&quot;No data to display&quot;);</code>这一句的意思是当没有显示出图表或是图表没有数据不显示时会显示我们定义的这些信息。  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">this.setVariableValue(&quot;jfreeChart&quot;, new JFreeChartRenderer(freeChart));
</code></pre></div>
<p>这一句当然是set数据了，JFreeChartRenderer这个类是JRRenderable接口的间接实现，从API上看jasperReport已不推荐我们使用了。OK，我们test一下吧！<br>
<strong>JChartReportMain.java</strong>  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">package org.bulktree.ireport.chart;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.HashMap;

import net.sf.jasperreports.engine.JREmptyDataSource;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.view.JasperViewer;

/**
 * @author bulktree Email: jutleo@gmail.com
 * @date Nov 28, 2008
 */
public class JChartReportMain {
    public static void main(String[] args) {
        String path = &quot;D:/workspace/JFreeChartReportDemo.jrxml&quot;;

        File file = new File(path);
        InputStream in;
        try {
            HashMap parameters = new HashMap();
            parameters.put(&quot;ReportTitle&quot;, &quot;LAOSHULIN&quot;);
            in = new FileInputStream(file);
            JasperReport jasperReport = JasperCompileManager.compileReport(in);
            JasperPrint jasperPrint = JasperFillManager.fillReport(jasperReport,
                    parameters, new JREmptyDataSource());
            JasperViewer viewer = new JasperViewer(jasperPrint);
            viewer.setVisible(true);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre></div>
<p><img src="/static/img/20130502007.jpg" alt="显示效果"> </p>

</div>
<p class="leo-protect">
  作者：
  <a href="/">leo</a>
  　发布时间：2013年05月03日
  <br>
  原文：
  <a href="/2013/05/03/iReport-jasperReport-10">iReport+jasperReport之JFreeChart（图表报表）</a>
  <br>
  标签： iReport、jasperReport
  <br/>
  版权所有，转载时必须以链接形式注明作者和原出处并保留本声明。
  <br>
</p>
<script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/static/js/prettify.js"></script>
<script type="text/javascript">
  $(function(){
    $("pre").addClass("prettyprint linenums");
    prettyPrint();
  });
</script>

<!-- Duoshuo Comment BEGIN -->
  <div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"jutleo"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- Duoshuo Comment END --></div></div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-success disabled">分类</a>
              
              <a href="/db/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>db </a>
              
              <a href="/server/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>server </a>
              
              <a href="/office/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>office </a>
              
              <a href="/javascript/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">6</span>javascript </a>
              
              <a href="/ireport/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">15</span>ireport </a>
              
              <a href="/blog/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>blog </a>
              
              <a href="/orm/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>orm </a>
              
              <a href="/technology/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>technology </a>
              
              <a href="/life/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">3</span>life </a>
              
              <a href="/spring/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">5</span>spring </a>
              
            </div>
            <div class="leo-article-category">
              <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=2975520964&verifier=eac976c7&dpc=1"></iframe>
            </div>

          </div>
      </div>

        </div>
        
      <div class="leo-foot">
        <p>
 Copyright &copy; 2010 - 2014 &nbsp;jutleo@gmail.com. 保留所有权利。
</p>
      </div>
    </body>
</html>
