<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>iReport+jasperReport之JDBC数据源</title>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/static/css/leo.css">
        <link rel="stylesheet" href="/static/css/prettify.css">

    </head>
    <body>
      <div class="leo-head">
        <ul class="leo-nav">
  
    <li><a class="leo-nav-item" href="/">首页</a></li>
  
    <li><a class="leo-nav-item" href="/category.html">归档</a></li>
  
    <li><a class="leo-nav-item" href="/andy.html">豆豆</a></li>
  
    <li><a class="leo-nav-item last" href="/contant.html">联系我</a></li>
  
</ul>

      </div>
          </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8"><div class="leo-category"><h1 class="leo-articel-title">iReport+jasperReport之JDBC数据源</h1>
<div class="post">
<p>iReport画出来的报表可以满足我们大部分的需要，所以采用iReport 编辑jrxml文件是我们的首选啦！当然掌握jrxml文件的结构也是必须的。<br>
采用JDBC数据源必须有数据库支持啊！我们新建一个test表，其中有pid、name、sex、password、department、age字段，为了方便期间我们定义这些字段全部为String类型。
在iReport中新建一报表，报表有title、pageHeader、columnHeader、detail、columnFooter、pageFooter、lastPageFooter、summary等部分，被成为<code>Report section</code>  </p>

<p>title：顾名思义是指报表的标题哦，它会显示在报表的最上面，如果有多页只会出现在第一页的最上面。<br>
pageHeader：每页的标题，如果有多页每页的开始都会显示此部分内容。<br>
columnHeader：显示报表的列头不经常使用。<br>
detail：这个就不用说了吧！<br>
有header就会出现footer啦！<br>
lastPageFooter只会出现在最后一页。<br>
summay会出现在每一页数据上，主要是为了展示一些统计信息，比如当前的时间，页数信息啦！  </p>

<p>新建一parameter<br>
<img src="/static/img/20130422005.jpg" alt="新建parameter"><br>
此参数可作为报表的标题使用，我们在程序中动态的传递给报表。<br>
document structure－－－》parameter里找到reportTitle参数拖至title区域，右击编辑reportTitle域的属性，
在font选项里找到Markup设置为HTML，TextField选项里设置Text Field Expreesion为  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&quot;&lt;font color=&#39;blue&#39; size=&#39;5&#39;&gt;&quot;+$P{reportTitle}+&quot;&lt;/font&gt;&quot;
</code></pre></div>
<p>下来就是设置报表的Field字段了，不需要我们一个个的新建那些字段啦！<br>
选择Data---&gt;Report Query在Report Query选项里选择Query Language为SQL，写入SqL语句  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">select * from test order by pid DESC
</code></pre></div>
<p>这时所有的field会出现在下面(SQL是正确的)<br>
关闭对话框在document structure－－－》field中就会出现我们需要的field，之后拖到相应的位置，关于怎么美化报表这个本人也不是很懂哦！<br>
如果需要显示一下当前的页数信息也可以自己托动Variables里的PAGE_NUMBER完成页数的显示。完整的jrxml文件如下：  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;  ?&gt;
&lt;!-- Created with iReport - A designer for JasperReports --&gt;
&lt;!DOCTYPE jasperReport PUBLIC &quot;//JasperReports//DTD Report Design//EN&quot; &quot;http://jasperreports.sourceforge.net/dtds/jasperreport.dtd&quot;&gt;
&lt;jasperReport
         name=&quot;Person&quot;
         columnCount=&quot;1&quot;
         printOrder=&quot;Vertical&quot;
         orientation=&quot;Portrait&quot;
         pageWidth=&quot;595&quot;
         pageHeight=&quot;842&quot;
         columnWidth=&quot;535&quot;
         columnSpacing=&quot;0&quot;
         leftMargin=&quot;30&quot;
         rightMargin=&quot;30&quot;
         topMargin=&quot;20&quot;
         bottomMargin=&quot;20&quot;
         whenNoDataType=&quot;NoPages&quot;
         isTitleNewPage=&quot;false&quot;
         isSummaryNewPage=&quot;false&quot;&gt;
    &lt;property name=&quot;ireport.scriptlethandling&quot; value=&quot;0&quot; /&gt;
    &lt;property name=&quot;ireport.encoding&quot; value=&quot;UTF-8&quot; /&gt;
    &lt;import value=&quot;java.util.*&quot; /&gt;
    &lt;import value=&quot;net.sf.jasperreports.engine.*&quot; /&gt;
    &lt;import value=&quot;net.sf.jasperreports.engine.data.*&quot; /&gt;

    &lt;parameter name=&quot;reportTitle&quot; isForPrompting=&quot;true&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;queryString&gt;&lt;![CDATA[select * from test order by pid DESC]]&gt;&lt;/queryString&gt;

    &lt;field name=&quot;pid&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;field name=&quot;name&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;field name=&quot;sex&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;field name=&quot;password&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;field name=&quot;department&quot; class=&quot;java.lang.String&quot;/&gt;
    &lt;field name=&quot;age&quot; class=&quot;java.lang.String&quot;/&gt;

        &lt;background&gt;
            &lt;band height=&quot;6&quot;  isSplitAllowed=&quot;true&quot; &gt;
            &lt;/band&gt;
        &lt;/background&gt;
        &lt;title&gt;
            &lt;band height=&quot;29&quot;  isSplitAllowed=&quot;true&quot; &gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;138&quot;
                        y=&quot;0&quot;
                        width=&quot;258&quot;
                        height=&quot;29&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement textAlignment=&quot;Center&quot; verticalAlignment=&quot;Middle&quot; markup=&quot;html&quot;&gt;
                        &lt;font pdfFontName=&quot;Helvetica-Bold&quot; isBold=&quot;true&quot;/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[&quot;&lt;font color=&#39;blue&#39; size=&#39;5&#39;&gt;&quot;+$P{reportTitle}+&quot;&lt;/font&gt;&quot;]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
            &lt;/band&gt;
        &lt;/title&gt;
        &lt;pageHeader&gt;
            &lt;band height=&quot;0&quot;  isSplitAllowed=&quot;true&quot; &gt;
            &lt;/band&gt;
        &lt;/pageHeader&gt;
        &lt;columnHeader&gt;
            &lt;band height=&quot;0&quot;  isSplitAllowed=&quot;true&quot; &gt;
            &lt;/band&gt;
        &lt;/columnHeader&gt;
        &lt;detail&gt;
            &lt;band height=&quot;22&quot;  isSplitAllowed=&quot;true&quot; &gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;0&quot;
                        y=&quot;0&quot;
                        width=&quot;100&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{pid}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;100&quot;
                        y=&quot;0&quot;
                        width=&quot;93&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{name}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;193&quot;
                        y=&quot;0&quot;
                        width=&quot;58&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{sex}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;251&quot;
                        y=&quot;0&quot;
                        width=&quot;100&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{password}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;351&quot;
                        y=&quot;0&quot;
                        width=&quot;100&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{department}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; pattern=&quot;&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;451&quot;
                        y=&quot;0&quot;
                        width=&quot;84&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement verticalAlignment=&quot;Top&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.String&quot;&gt;&lt;![CDATA[$F{age}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;line direction=&quot;TopDown&quot;&gt;
                    &lt;reportElement
                        x=&quot;0&quot;
                        y=&quot;17&quot;
                        width=&quot;535&quot;
                        height=&quot;1&quot;
                        key=&quot;line-1&quot;/&gt;
                    &lt;graphicElement stretchType=&quot;NoStretch&quot;/&gt;
                &lt;/line&gt;
            &lt;/band&gt;
        &lt;/detail&gt;
        &lt;columnFooter&gt;
            &lt;band height=&quot;0&quot;  isSplitAllowed=&quot;true&quot; &gt;
            &lt;/band&gt;
        &lt;/columnFooter&gt;
        &lt;pageFooter&gt;
            &lt;band height=&quot;24&quot;  isSplitAllowed=&quot;true&quot; &gt;
                &lt;textField isStretchWithOverflow=&quot;false&quot; isBlankWhenNull=&quot;false&quot; evaluationTime=&quot;Now&quot; hyperlinkType=&quot;None&quot;  hyperlinkTarget=&quot;Self&quot; &gt;
                    &lt;reportElement
                        x=&quot;387&quot;
                        y=&quot;5&quot;
                        width=&quot;22&quot;
                        height=&quot;18&quot;
                        key=&quot;textField&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement textAlignment=&quot;Center&quot; verticalAlignment=&quot;Middle&quot;&gt;
                        &lt;font/&gt;
                    &lt;/textElement&gt;
                &lt;textFieldExpression   class=&quot;java.lang.Integer&quot;&gt;&lt;![CDATA[$V{PAGE_NUMBER}]]&gt;&lt;/textFieldExpression&gt;
                &lt;/textField&gt;
                &lt;staticText&gt;
                    &lt;reportElement
                        x=&quot;373&quot;
                        y=&quot;5&quot;
                        width=&quot;14&quot;
                        height=&quot;17&quot;
                        key=&quot;staticText-2&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement textAlignment=&quot;Center&quot; verticalAlignment=&quot;Middle&quot;&gt;
                        &lt;font pdfFontName=&quot;Helvetica-Bold&quot; size=&quot;12&quot; isBold=&quot;true&quot;/&gt;
                    &lt;/textElement&gt;
                &lt;text&gt;&lt;![CDATA[第]]&gt;&lt;/text&gt;
                &lt;/staticText&gt;
                &lt;staticText&gt;
                    &lt;reportElement
                        x=&quot;409&quot;
                        y=&quot;5&quot;
                        width=&quot;14&quot;
                        height=&quot;17&quot;
                        key=&quot;staticText-3&quot;/&gt;
                    &lt;box&gt;&lt;/box&gt;
                    &lt;textElement textAlignment=&quot;Center&quot; verticalAlignment=&quot;Middle&quot;&gt;
                        &lt;font pdfFontName=&quot;Helvetica-Bold&quot; size=&quot;12&quot; isBold=&quot;true&quot;/&gt;
                    &lt;/textElement&gt;
                &lt;text&gt;&lt;![CDATA[页]]&gt;&lt;/text&gt;
                &lt;/staticText&gt;
            &lt;/band&gt;
        &lt;/pageFooter&gt;
        &lt;summary&gt;
            &lt;band height=&quot;0&quot;  isSplitAllowed=&quot;true&quot; &gt;
            &lt;/band&gt;
        &lt;/summary&gt;
&lt;/jasperReport&gt;
</code></pre></div>
<p>我们可以直接使用ireport查看预览效果，但是大部分我们是在应用程序中使用的哦！我们看看我们怎么让这个jrxml模板文件工作呢？  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">File file = new File(&quot;Person.jrxml&quot;);
InputStream in = new FileInputStream(file); // 编译报表 jasperReport =
jasperReport = JasperCompileManager.compileReport(in);
</code></pre></div>
<p>编译文件是很耗时的工作，通常这个由iReport去做我们使用jasper文件即可，  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">jasperReport = (JasperReport) JRLoader
                .loadObject(&quot;D:\\workspace\\Person.jasper&quot;);
</code></pre></div>
<p>产生了JasperReport对象下来就是要填充数据了，采用JDBC方式我们需要一个打开的connection(数据库连接)，<br>
还有报表需要的parameter：  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">public HashMap getMap() {

    HashMap map = new HashMap();
    map.put(&quot;reportTitle&quot;, &quot;laoshulin&quot;);
    return map;
}
jasperPrint = JasperFillManager
                .fillReport(jasperReport, getMap, getConn());
</code></pre></div>
<p>针对jasperPrint对象JasperReport有很多的API可以提供各种方式的预览或是生成文件，我只说说JasperViewer吧！其它的看看api或是google一下就知道了  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">JasperViewer jasperViewer = new JasperViewer(jasperPrint);
</code></pre></div>
<p>JasperViewer 继承自JFrame类，<code>jasperViewer.setVisible(true);</code><br>
这样就可以预览报表了。  </p>

<p><code>JRViewer</code>这个类继承<code>Jpanel</code>，我们可以在web中使用它，后面介绍客户端打印时再详细介绍。  </p>

<p>JDBC数据源很简单主要是SQL的功底，但是它是最基础的，网上一大堆这方面的介绍哦，可以参考别人的多看看哦，
我写的这些都有点语无伦次了，主要是我自己不怎么写东西，多以代码的形式留给自己了，现在写出来和大家交流，
当时做这个的时候找了好多的文章没有一篇写的深刻的，大多都是copy的。  </p>

</div>
<p class="leo-protect">
  作者：
  <a href="/">leo</a>
  　发布时间：2013年04月22日
  <br>
  原文：
  <a href="/2013/04/22/iReport-jasperReport-03">iReport+jasperReport之JDBC数据源</a>
  <br>
  标签： iReport、jasperReport
  <br/>
  版权所有，转载时必须以链接形式注明作者和原出处并保留本声明。
  <br>
</p>
<script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/static/js/prettify.js"></script>
<script type="text/javascript">
  $(function(){
    $("pre").addClass("prettyprint linenums");
    prettyPrint();
  });
</script>

<!-- Duoshuo Comment BEGIN -->
  <div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"jutleo"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- Duoshuo Comment END --></div></div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-success disabled">分类</a>
              
              <a href="/db/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>db </a>
              
              <a href="/server/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>server </a>
              
              <a href="/office/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>office </a>
              
              <a href="/javascript/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">6</span>javascript </a>
              
              <a href="/ireport/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">15</span>ireport </a>
              
              <a href="/blog/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>blog </a>
              
              <a href="/orm/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>orm </a>
              
              <a href="/technology/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>technology </a>
              
              <a href="/life/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">3</span>life </a>
              
              <a href="/spring/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">5</span>spring </a>
              
            </div>
            <div class="leo-article-category">
              <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=2975520964&verifier=eac976c7&dpc=1"></iframe>
            </div>

          </div>
      </div>

        </div>
        
      <div class="leo-foot">
        <p>
 Copyright &copy; 2010 - 2014 &nbsp;jutleo@gmail.com. 保留所有权利。
</p>
      </div>
    </body>
</html>
