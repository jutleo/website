<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>spring security 基础</title>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/static/css/leo.css">
        <link rel="stylesheet" href="/static/css/prettify.css">

    </head>
    <body>
      <div class="leo-head">
        <ul class="leo-nav">
  
    <li><a class="leo-nav-item" href="/">首页</a></li>
  
    <li><a class="leo-nav-item" href="/category.html">归档</a></li>
  
    <li><a class="leo-nav-item" href="/andy.html">豆豆</a></li>
  
    <li><a class="leo-nav-item last" href="/contant.html">联系我</a></li>
  
</ul>

      </div>
          </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8"><div class="leo-category"><h1 class="leo-articel-title">spring security 基础</h1>
<div class="post">
<h2>开篇</h2>

<p>&emsp;如果你对<code>spring security</code>有疑问，请先阅读官方文档，由于本文提到的<code>spring security</code>是基于2.0.8版本的，可能跟最新3的版本有出入，请自行查阅文档，思路都是想通的。</p>

<h2>说明</h2>

<p>&emsp;<code>spring security</code>是基于<code>spring AOP</code> 和 <code>Servlet</code>的安全过滤框架，基于Web请求访问和方法调用处理身份验证和授权。试想它出现在系统中的原因及作用？</p>

<h2>原理</h2>

<p>&emsp;<code>spring security</code>分为三部分：安全拦截、身份认证、授权资源</p>

<p>&emsp;<code>AbstractSecurityInterceptor</code> 负责拦截所有用户请求，<code>FilterSecurityInterceptor</code>负责使用过滤用户的权限，在过滤用户权限时，<code>spring security</code>使用认证管理器(<code>AuthenticationManager</code>)
&emsp;调用认证提供者(&#39;AuthenticationProvider&#39;)去认证用户是否合法，认证提供者通过调用<code>UserDetailsService</code>接口的<code>loadUserByUsername</code>方法实现用户验证。<br>
&emsp;<code>spring</code>默认为我们提供了，权限提供者<code>DaoAuthencationProvider</code>，实现从数据库进行密码验证。<br>
&emsp;<code>spring</code>默认为我们提供了<code>UserDetailsService</code>的实现<code>JdbcDaoImpl</code>，实现用户信息、权限信息加载。  </p>

<p>&emsp;当认证通过后，受保护资源才可以访问。用户通过认证后<code>spring security</code>将会写入认证标识到本地线程。  </p>

<h2>具体配置</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;security:http auto-config=&quot;true&quot; access-denied-page=&quot;/core/login/loginError.jsp?login_error=1&quot;&gt;
    &lt;security:form-login login-page=&quot;/core/login/login.jsp&quot; authentication-failure-url=&quot;/core/login/loginError.jsp?login_error=1&quot; default-target-url=&quot;/core/pcis_main.jsp&quot; /&gt;
    &lt;security:logout logout-success-url=&quot;/core/login/login.jsp&quot; /&gt;
    &lt;security:intercept-url pattern=&quot;/core/login/**&quot; filters=&quot;none&quot; /&gt;
    &lt;security:intercept-url pattern=&quot;/core/skin/**&quot; filters=&quot;none&quot; /&gt;
    &lt;security:intercept-url pattern=&quot;/core/js/**&quot; filters=&quot;none&quot; /&gt;
    &lt;security:intercept-url pattern=&quot;/**&quot; access=&quot;ROLE_EVERYONE&quot; /&gt;
&lt;/security:http&gt;
</code></pre></div>
<p><code>auto-config=&quot;true&quot;</code> 表示使用默认的过滤器链条，也可自定义，请参阅官方文档<br>
<code>access-denied-page</code> 无权限时的跳转页<br>
<code>security:form-login</code> 控制登录页面<br>
<code>login-page</code> 登录页<br>
<code>authentication-failure-url</code> 登录失败页<br>
<code>default-target-url</code> 认证且有权限后的默认跳转页  </p>

<p>&emsp;以下是认证管理配置  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;authentication-manager&gt;  
    &lt;authentication-provider&gt;  
        &lt;password-encoder hash=&quot;md5&quot;&gt;  
            &lt;salt-source user-property=&quot;username&quot;/&gt;  
        &lt;/password-encoder&gt;  
        &lt;jdbc-user-service data-source-ref=&quot;dataSource&quot;  
            users-by-username-query=&quot;select username,password,enabled from tb_user where username = ? and enabled = 1&quot;  
            authorities-by-username-query=&quot;select u.username,r.name from t_user u join user_role ur on u.uid = ur.uid join t_role r on r.rid = ur.rid where u.username = ?&quot; /&gt;  
    &lt;/authentication-provider&gt;  
&lt;/authentication-manager&gt;
</code></pre></div>
<p>&emsp;认证提供者默认使用的是DaoAuthenticationProvider，可选配置 密码加密方式，提供数据源 用户信息sql、权限sql </p>

<p>结合spring framework 将会提供默认的登录提示。不在赘述。  </p>

</div>
<p class="leo-protect">
  作者：
  <a href="/">leo</a>
  　发布时间：2014年05月12日
  <br>
  原文：
  <a href="/2014/05/12/spring-security-01">spring security 基础</a>
  <br>
  标签： spring
  <br/>
  版权所有，转载时必须以链接形式注明作者和原出处并保留本声明。
  <br>
</p>
<script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/static/js/prettify.js"></script>
<script type="text/javascript">
  $(function(){
    $("pre").addClass("prettyprint linenums");
    prettyPrint();
  });
</script>

<!-- Duoshuo Comment BEGIN -->
  <div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"jutleo"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- Duoshuo Comment END --></div></div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-success disabled">分类</a>
              
              <a href="/db/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>db </a>
              
              <a href="/server/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>server </a>
              
              <a href="/office/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>office </a>
              
              <a href="/javascript/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">6</span>javascript </a>
              
              <a href="/ireport/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">15</span>ireport </a>
              
              <a href="/blog/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>blog </a>
              
              <a href="/orm/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>orm </a>
              
              <a href="/technology/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>technology </a>
              
              <a href="/life/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">3</span>life </a>
              
              <a href="/spring/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">5</span>spring </a>
              
            </div>
            <div class="leo-article-category">
              <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=2975520964&verifier=eac976c7&dpc=1"></iframe>
            </div>

          </div>
      </div>

        </div>
        
      <div class="leo-foot">
        <p>
 Copyright &copy; 2010 - 2014 &nbsp;jutleo@gmail.com. 保留所有权利。
</p>
      </div>
    </body>
</html>
