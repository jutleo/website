<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>javascript高级特性 -- 作用域</title>
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css">
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/static/css/leo.css">
        <link rel="stylesheet" href="/static/css/prettify.css">

    </head>
    <body>
      <div class="leo-head">
        <ul class="leo-nav">
  
    <li><a class="leo-nav-item" href="/">首页</a></li>
  
    <li><a class="leo-nav-item" href="/category.html">归档</a></li>
  
    <li><a class="leo-nav-item" href="/andy.html">豆豆</a></li>
  
    <li><a class="leo-nav-item last" href="/contant.html">联系我</a></li>
  
</ul>

      </div>
          </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8"><div class="leo-category"><h1 class="leo-articel-title">javascript高级特性 -- 作用域</h1>
<div class="post">
<p>&emsp;作用域在javascript中分为全局作用域和局部作用域，而局部作用域其实指得就是函数作用域，javascript将函数作为作用域的最小范围。</p>

<h6>全局作用域 Global Scope</h6>

<p>&emsp;在代码的任何地方都可以访问到的对象，比如window对象及window对象的属性，就拥有全局作用域。<br>
1、在最外层定义的变量，默认都是window对象的属性；<br>
2、未定义的变量默认都是全局的，默认也都是window对象的属性； 这一条是经常犯的错误,但是新版浏览器已经修复了这个问题！<br>
举例如下：</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var firstName = &quot;leo&quot;;
function changeName() {
    var secondName = &quot;jut&quot;;
    fullName = &quot;jutleo&quot;;
    function getName() {
        console.log(secondName);
    }
    getName();
}
console.log(firstName);
console.log(fullName);//报错
// console.log(secondName);//报错
changeName();
// getName();//报错
</code></pre></div>
<h6>局部作用域/函数作用域(Local Scope/Function Scope)</h6>

<p>&emsp;在函数中定义一个变量时，这个变量只对当前函数可见,javascript会搜索当前函数的作用域，如果没有找到，则继续向上层搜索，直到在全局作用域也没有找到会返回undefined；</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var version = &quot;version_1&quot;;
var f1 = function() {
    console.log(version);//version_1
}
f1(); 
</code></pre></div>
<p>&emsp;在f1函数中没有找到，继续往上查找  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var version = &quot;version_1&quot;;
var f2 = function() {
    var version = &quot;version_2&quot;;
    console.log(version);//version_2
}
f2();
</code></pre></div>
<p>&emsp;在f2函数中直接找到</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var socpe = &quot;scope_01&quot;;
var f3 = function() {
    console.log(scope); //undefined
    var scope = &quot;scope_02&quot;;
}
f3();
</code></pre></div>
<p>&emsp;这又是为什么呢？原来javascript在f3函数内搜索scope变量，并且找到了，这个时候外层的scope就被忽略了，但是执行到<code>console.log(scope)</code>时，scope还没有被初始化，所以返回<code>undefined</code></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var f4 = function() {
    var scope = &quot;scope_02&quot;;
    (function(){
        var scope = &quot;scope_03&quot;;
        (function(){
            console.log(scope); //scope_03
        })();
    })();
}
f4();
</code></pre></div>
<p>&emsp;嵌套也是要遵循同样的规则的，先在函数内部查找，没有找到继续往上层找！</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var x_scope = &quot;leo&quot;;
var f5 = function() {
    console.log(x_scope); //leo
}
var f6 = function() {
    var x_scope = &quot;jut&quot;;
    f5();
}
f6();
</code></pre></div>
<p>&emsp;这又是为什么呢？原来javascript函数嵌套时，作用域是由嵌套关系决定的，调用的顺序忽略不记！</p>

<p>&emsp;说了这么多，这个作用域如何使用呢？我们从以上例子可以看出，javascript在查找变量时，顺序往上找的这个链条就作用域链。在实际应用中变量的位置越深，读写的速度就越慢，直到找到全局作用域中。  </p>

<p>看例子：  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">function setLabelBgColor(){
    document.getElementById(&quot;btn&quot;).onclick=function(){
        document.getElementById(&quot;label&quot;).style.backgroundColor=&quot;red&quot;;
    };
}
</code></pre></div>
<p>&emsp;根据作用域链的查找逻辑，查找document变量必须遍历整个作用域链，直到最后在全局对象中才能找到，这个函数引用了两次。优化如下：  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">function setLabelBgColor(){
    var doc = document;
    doc.getElementById(&quot;btn&quot;).onclick=function(){
        doc.getElementById(&quot;label&quot;).style.backgroundColor=&quot;red&quot;;
    };
}
</code></pre></div>
<p>&emsp;这个只是个例子，这么做并不会大幅提升性能哦！但是在实际使用中要避免全局变量被大量访问的情况。  </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">(function(exports){
    //do some thing ...
})(window);
</code></pre></div>
<p>&emsp;思考一下，为什么看到的库、框架都是这么开始的？  </p>

</div>
<p class="leo-protect">
  作者：
  <a href="/">leo</a>
  　发布时间：2014年01月09日
  <br>
  原文：
  <a href="/2014/01/09/javascript-scope">javascript高级特性 -- 作用域</a>
  <br>
  标签： javascript
  <br/>
  版权所有，转载时必须以链接形式注明作者和原出处并保留本声明。
  <br>
</p>
<script type="text/javascript" src="/static/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/static/js/prettify.js"></script>
<script type="text/javascript">
  $(function(){
    $("pre").addClass("prettyprint linenums");
    prettyPrint();
  });
</script>

<!-- Duoshuo Comment BEGIN -->
  <div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"jutleo"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
  </script>
<!-- Duoshuo Comment END --></div></div>
          <div class="col-md-4">
            <div class="list-group">
              <a href="#" class="list-group-item list-group-item-success disabled">分类</a>
              
              <a href="/db/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>db </a>
              
              <a href="/server/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>server </a>
              
              <a href="/office/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>office </a>
              
              <a href="/javascript/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">6</span>javascript </a>
              
              <a href="/ireport/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">15</span>ireport </a>
              
              <a href="/blog/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>blog </a>
              
              <a href="/orm/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">2</span>orm </a>
              
              <a href="/technology/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">1</span>technology </a>
              
              <a href="/life/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">3</span>life </a>
              
              <a href="/spring/"  class="list-group-item" title="查看所有此分类文章列表"><span class="badge">5</span>spring </a>
              
            </div>
            <div class="leo-article-category">
              <iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=1&isTitle=1&noborder=1&isWeibo=1&isFans=1&uid=2975520964&verifier=eac976c7&dpc=1"></iframe>
            </div>

          </div>
      </div>

        </div>
        
      <div class="leo-foot">
        <p>
 Copyright &copy; 2010 - 2014 &nbsp;jutleo@gmail.com. 保留所有权利。
</p>
      </div>
    </body>
</html>
